<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>DCF Debug Verze</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-100 p-10 font-sans">

    <div class="max-w-md mx-auto bg-white p-8 rounded-2xl shadow-lg text-slate-800">
        <h1 class="text-xl font-bold mb-4">DCF Diagnostika</h1>
        
        <input type="text" id="ticker" placeholder="Např. AAPL" class="w-full border p-3 rounded-lg mb-4 uppercase font-bold">
        
        <button onclick="testAPI()" id="btn" class="w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition">
            Zkusit načíst data
        </button>

        <div id="log" class="mt-6 p-4 bg-slate-50 rounded-lg text-xs font-mono border border-slate-200 overflow-auto max-h-60">
            Zde se zobrazí technický výpis...
        </div>

        <div id="result" class="mt-4 hidden">
            <p class="text-sm font-bold text-gray-500">Načtená data:</p>
            <div id="dataView" class="text-sm bg-green-50 p-2 rounded border border-green-200 mt-1"></div>
        </div>
    </div>

    <script>
        const API_KEY = 'TDAEXfruGIrHWfxNJuP28M3GIb3xU6UD';

        async function testAPI() {
            const ticker = document.getElementById('ticker').value.toUpperCase().trim();
            const log = document.getElementById('log');
            const resDiv = document.getElementById('result');
            const dataView = document.getElementById('dataView');
            
            if (!ticker) return alert("Zadej ticker!");

            log.innerText = "1. Připojování k API...\n";
            
            try {
                const url = `https://financialmodelingprep.com/api/v3/quote/${ticker}?apikey=${API_KEY}`;
                log.innerText += `2. Volám URL: ${url}\n`;
                
                const response = await fetch(url);
                log.innerText += `3. Status odpovědi: ${response.status} ${response.statusText}\n`;
                
                const data = await response.json();
                log.innerText += `4. Raw data od serveru: ${JSON.stringify(data)}\n`;

                if (Array.isArray(data) && data.length > 0) {
                    log.innerText += `5. ÚSPĚCH: Ticker nalezen.\n`;
                    resDiv.classList.remove('hidden');
                    dataView.innerText = `Firma: ${data[0].name}\nCena: $${data[0].price}\nAkcie: ${data[0].sharesOutstanding}`;
                } else if (data['Error Message']) {
                    log.innerText += `❌ CHYBA API: ${data['Error Message']}\n`;
                } else {
                    log.innerText += `❌ SERVER NIC NEVRÁTIL: Seznam je prázdný. Možná neplatný ticker nebo omezení Free tarifu.\n`;
                }
            } catch (err) {
                log.innerText += `❌ KRITICKÁ CHYBA: ${err.message}\n`;
                log.innerText += `Tip: Pokud vidíte 'Failed to fetch', váš prohlížeč blokuje spojení. Zkuste vypnout AdBlock nebo web nahrát na GitHub.\n`;
            }
        }
    </script>
</body>
</html>
